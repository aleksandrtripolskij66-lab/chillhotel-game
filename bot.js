const TelegramBot = require('node-telegram-bot-api');
const express = require('express');

const app = express();
const TOKEN = process.env.TOKEN;
const bot = new TelegramBot(TOKEN, {polling: true});

const GAME_URL = 'https://chillhotel-game.aleksandrtripol.repl.co';

// –ü—Ä–æ—Å—Ç–æ–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
app.get('/', (req, res) => {
  res.send('üè® ChillHotel Bot is running!');
});

app.listen(3000, () => {
  console.log('üöÄ Web server started on port 3000');
});

console.log('ü§ñ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ Replit!');

bot.onText(/\/start/, (msg) => {
  const chatId = msg.chat.id;
  bot.sendMessage(chatId, 'üè® –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ChillHotel!', {
    reply_markup: {
      inline_keyboard: [
        [{text: "üéÆ –ò–≥—Ä–∞—Ç—å", web_app: {url: GAME_URL}}]
      ]
    }
  });
});

// –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É /help
bot.onText(/\/help/, (msg) => {
  const chatId = msg.chat.id;
  bot.sendMessage(chatId, `üéÆ *–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã ChillHotel:*

üè® –¢—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –æ—Ç–µ–ª–µ–º! 
‚Ä¢ –ü—Ä–∏–Ω–∏–º–∞–π –≥–æ—Å—Ç–µ–π
‚Ä¢ –£–ª—É—á—à–∞–π –Ω–æ–º–µ—Ä–∞
‚Ä¢ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –¥–µ–Ω—å–≥–∏

üì± *–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:*
1. –ù–∞–∂–º–∏ "üéÆ –ò–≥—Ä–∞—Ç—å"
2. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–≥—Ä–æ–≤–æ–µ –æ–∫–Ω–æ
3. –£–ø—Ä–∞–≤–ª—è–π –æ—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

‚ö° *–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:*
‚Ä¢ –ó–∞—Å–µ–ª–µ–Ω–∏–µ –≥–æ—Å—Ç–µ–π
‚Ä¢ –£–±–æ—Ä–∫–∞ –Ω–æ–º–µ—Ä–æ–≤
‚Ä¢ –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π
‚Ä¢ –ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –æ—Ç–µ–ª—è

–ï—Å–ª–∏ –∏–≥—Ä–∞ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –ø–æ–ø—Ä–æ–±—É–π:
‚Ä¢ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
‚Ä¢ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ (/start)`, {parse_mode: 'Markdown'});
});

// –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É /rules
bot.onText(/\/rules/, (msg) => {
  const chatId = msg.chat.id;
  bot.sendMessage(chatId, `üìñ *–ü—Ä–∞–≤–∏–ª–∞ ChillHotel:*

üéØ *–¶–µ–ª—å –∏–≥—Ä—ã:*
–°—Ç–∞—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –ª—É—á—à–µ–≥–æ –æ—Ç–µ–ª—è –≤ –≥–æ—Ä–æ–¥–µ!

üìä *–ú–µ—Ö–∞–Ω–∏–∫–∞:*
‚Ä¢ –ö–∞–∂–¥—ã–π –≥–æ—Å—Ç—å –ø—Ä–∏–Ω–æ—Å–∏—Ç –¥–æ—Ö–æ–¥
‚Ä¢ –ß–µ–º –ª—É—á—à–µ –Ω–æ–º–µ—Ä - —Ç–µ–º –±–æ–ª—å—à–µ –ø–ª–∞—Ç—è—Ç
‚Ä¢ –£–ª—É—á—à–∞–π –æ—Ç–µ–ª—å –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –¥–æ—Ö–æ–¥–∞

‚≠ê *–£—Ä–æ–≤–Ω–∏ –æ—Ç–µ–ª—è:*
1Ô∏è‚É£ –°—Ç–∞—Ä—Ç–æ–≤—ã–π (5 –Ω–æ–º–µ—Ä–æ–≤)
2Ô∏è‚É£ –ë–∏–∑–Ω–µ—Å-–∫–ª–∞—Å—Å (10 –Ω–æ–º–µ—Ä–æ–≤) 
3Ô∏è‚É£ –õ—é–∫—Å-–æ—Ç–µ–ª—å (20 –Ω–æ–º–µ—Ä–æ–≤)
4Ô∏è‚É£ –ü—è—Ç–∏–∑–≤–µ–∑–¥–æ—á–Ω—ã–π (50 –Ω–æ–º–µ—Ä–æ–≤)

üí° *–°–æ–≤–µ—Ç—ã:*
‚Ä¢ –ù–µ –∑–∞–±—ã–≤–∞–π —É–±–∏—Ä–∞—Ç—å –Ω–æ–º–µ—Ä–∞
‚Ä¢ –£–ª—É—á—à–∞–π –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
‚Ä¢ –ü—Ä–∏–≤–ª–µ–∫–∞–π VIP-–≥–æ—Å—Ç–µ–π`, {parse_mode: 'Markdown'});
});
